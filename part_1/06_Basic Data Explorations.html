

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chapter 6: Basic Data Explorations &#8212; An African flavour to Data Preprocessing Recipes</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'part_1/06_Basic Data Explorations';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter 7: Data Organization Methods" href="07_Data%20Organization%20Methods.html" />
    <link rel="prev" title="Chapter 5: Grouping the Data" href="05_Grouping_Data.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/ending_ia.jpeg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/ending_ia.jpeg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    An African flavour to Data Preprocessing Recipes
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">1. An overview of Data Science tools</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../part_0/00_The%20hype%20of%20Data%20Science.html">Chapter 1: The Data Science Ecosystem</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../part_0/01_Getting%20Started%20with%20Jupyter%20and%20Colab.html">Chapter 2: Getting started with Jupyter and Colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part_0/02_Python_for_Data_Science.html">Chapter 3: Introduction to Python for Data Science</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">2. Dealing with tabular data</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_Refresher%20on%20Series%20and%20DataFrame.html">Chapter 1: Working with Series and DataFrames</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_Data_Reading_Methods.html">Chapter 2: Data Reading Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_Tidying_the_Data.html">Chapter 3: Introducing Features and Observations</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_Handling%20Text%20Data.html">Chapter 4: Handling Text Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_Grouping_Data.html">Chapter 5: Grouping the Data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chapter 6: Basic Data Explorations</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_Data%20Organization%20Methods.html">Chapter 7: Data Organization Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_Customizing%20functions.html">Chapter 8: Customizing Functions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">3. Dealing with Time Series</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part_2/01_Working%20with%20Time%20Data.html">Chapter 1: Working with Time Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part_2/02_Basic%20Data%20Manipulation%20%20on%20Time%20Series_OK.html">Chapter 2: Basic Data Manipulation  on Time Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part_2/03_%20Advanced%20Manipulation%20on%20Time%20Series_OK.html">Chapter 3: Advanced Manipulation on Time Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part_2/04_Framing%20TimeSeries%20_OK.html">Chapter 4: Framing Time Series</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">4. Dealing with Image data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part_3/01_Introduction%20to%20Image%20Data.html">Chapter 1: Introduction to Image Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part_3/02_Basic_Image%20Pre-processing_operations.html">Chapter 2: Basic Image Pre-processing operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part_3/03_Advanced%20Image%20Pre-processing%20operations.html">Chapter 3: Advanced Image Pre-processing operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part_3/04_Feature%20Extraction%20from%20Images_SVD.html">Chapter 4: Feature Extraction from Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part_3/05_Preparing%20Images%20Data%20for%20Model%20Training.html">Chapter 5: Preparing Image Data for Model Training</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">5. Dealing with Text data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part_4/01_Strings%20as%20Text%20Data%20in%20Python.html">Chapter 1: Introduction to Text Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part_4/02_Text%20Mining%20Operations.html">Chapter 2: Text Mining Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part_4/03_Feature%20Extraction%20from%20Texts.html">Chapter 3: Feature Extraction from Text Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part_4/04_Word%20Embeddings.html">Chapter 4: Word Embeddings</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/rock-feller/rock-feller.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/rock-feller/rock-feller.github.io/issues/new?title=Issue%20on%20page%20%2Fpart_1/06_Basic Data Explorations.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/part_1/06_Basic Data Explorations.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 6: Basic Data Explorations</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#viewing-data">1. Viewing Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-the-head-and-the-tail-method">1.a) The <em>.head()</em>  and the <em>.tail()</em> method</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#selection">2. Selection</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-selection-by-labels-the-loc-method">2.a) Selection by Labels: The <code class="docutils literal notranslate"><span class="pre">.loc[</span> <span class="pre">]</span></code> method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-selection-by-location-the-iloc-method">2.b) Selection by Location: The <code class="docutils literal notranslate"><span class="pre">.iloc[</span> <span class="pre">]</span></code> method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-selection-on-dtype">2.c) Selection on dtype</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering">3. Filtering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-the-boolean-condition">3.a) The Boolean condition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-1-filtering-on-the-lines">3.a.1. Filtering on the lines</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-2-filtering-on-columns">3.a.2. Filtering on columns</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-3-application-of-multiple-conditions">3.a.3. Application of multiple conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-4-boolean-reductions">3.a.4.  Boolean reductions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-5-filtering-with-the-isin-method">3.a.5. Filtering with the <code class="docutils literal notranslate"><span class="pre">.isin(</span> <span class="pre">)</span></code> method</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#editing">4. Editing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-adding-inserting-and-deleting-a-column-in-a-dataframe">4.a. Adding, inserting, and deleting a column in a DataFrame</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-adding-new-columns-with-assign">4.b. Adding new columns with assign()</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptive-statistics">5. Descriptive Statistics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-the-describe-method">5.a) The <code class="docutils literal notranslate"><span class="pre">.describe(</span> <span class="pre">)</span></code> method</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transposition-sorting-and-reindexing">6.  Transposition, Sorting and Reindexing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-transposition">6.a. Transposition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-sorting">6.b. Sorting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-1-sorting-by-label">6.b.1. Sorting by label</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-2-sorting-by-values">6.b.2. Sorting by values</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reindexing">7. Reindexing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-reindexing-using-another-dataframe-as-a-reference">7.a. Reindexing using another DataFrame as a reference</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="tex2jax_ignore mathjax_ignore section" id="chapter-6-basic-data-explorations">
<h1>Chapter 6: Basic Data Explorations<a class="headerlink" href="#chapter-6-basic-data-explorations" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="viewing-data">
<h2>1. Viewing Data<a class="headerlink" href="#viewing-data" title="Permalink to this heading">#</a></h2>
<p>In this section, we will see how to view the data within a DataFrame in a
simple and direct way, using
appropriate methods made available to the Pandas library</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">random_numbers</span> <span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.287888</td>
      <td>0.353575</td>
      <td>0.341708</td>
      <td>0.622832</td>
      <td>0.611452</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.061828</td>
      <td>0.699297</td>
      <td>0.977237</td>
      <td>0.543010</td>
      <td>0.011045</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.865775</td>
      <td>0.534272</td>
      <td>0.686670</td>
      <td>0.375884</td>
      <td>0.722322</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.427374</td>
      <td>0.628699</td>
      <td>0.383110</td>
      <td>0.208596</td>
      <td>0.301745</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.611501</td>
      <td>0.730752</td>
      <td>0.778461</td>
      <td>0.507769</td>
      <td>0.830542</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.822372</td>
      <td>0.940225</td>
      <td>0.996775</td>
      <td>0.276070</td>
      <td>0.221705</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.981665</td>
      <td>0.263222</td>
      <td>0.483972</td>
      <td>0.448115</td>
      <td>0.698585</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.788616</td>
      <td>0.663250</td>
      <td>0.709085</td>
      <td>0.646127</td>
      <td>0.885067</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.837928</td>
      <td>0.160876</td>
      <td>0.719921</td>
      <td>0.495707</td>
      <td>0.042354</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.780700</td>
      <td>0.083553</td>
      <td>0.765147</td>
      <td>0.812450</td>
      <td>0.990125</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.770597</td>
      <td>0.579099</td>
      <td>0.554982</td>
      <td>0.193273</td>
      <td>0.715738</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.872885</td>
      <td>0.484358</td>
      <td>0.749639</td>
      <td>0.499975</td>
      <td>0.755507</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.537080</td>
      <td>0.950478</td>
      <td>0.162069</td>
      <td>0.004849</td>
      <td>0.256844</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.667947</td>
      <td>0.709389</td>
      <td>0.377085</td>
      <td>0.076337</td>
      <td>0.179740</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.881816</td>
      <td>0.610919</td>
      <td>0.170058</td>
      <td>0.672130</td>
      <td>0.160582</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.684519</td>
      <td>0.861120</td>
      <td>0.323825</td>
      <td>0.204518</td>
      <td>0.372080</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.529079</td>
      <td>0.643015</td>
      <td>0.502276</td>
      <td>0.655703</td>
      <td>0.835930</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.188806</td>
      <td>0.689956</td>
      <td>0.302925</td>
      <td>0.154651</td>
      <td>0.841859</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.235813</td>
      <td>0.978315</td>
      <td>0.273838</td>
      <td>0.912379</td>
      <td>0.842504</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.204934</td>
      <td>0.328844</td>
      <td>0.863875</td>
      <td>0.406913</td>
      <td>0.409407</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As you can see, a part of the contents of the DataFrame have been be displayed, including the indexes with their labels.</p>
<div class="section" id="a-the-head-and-the-tail-method">
<h3>1.a) The <em>.head()</em>  and the <em>.tail()</em> method<a class="headerlink" href="#a-the-head-and-the-tail-method" title="Permalink to this heading">#</a></h3>
<p>To have a sufficient view to roughly understand the structure of a
DataFrame and get an idea of the data it contains, the Pandas library
provides us with the two methods <code class="docutils literal notranslate"><span class="pre">head()</span></code> and <code class="docutils literal notranslate"><span class="pre">tail()</span></code>. By calling these
methods on a reference DataFrame, the first five lines are printed, with the
<code class="docutils literal notranslate"><span class="pre">head()</span></code> method, or the last five lines with the <code class="docutils literal notranslate"><span class="pre">tail()</span></code> method, as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.287888</td>
      <td>0.353575</td>
      <td>0.341708</td>
      <td>0.622832</td>
      <td>0.611452</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.061828</td>
      <td>0.699297</td>
      <td>0.977237</td>
      <td>0.543010</td>
      <td>0.011045</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.865775</td>
      <td>0.534272</td>
      <td>0.686670</td>
      <td>0.375884</td>
      <td>0.722322</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.427374</td>
      <td>0.628699</td>
      <td>0.383110</td>
      <td>0.208596</td>
      <td>0.301745</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.611501</td>
      <td>0.730752</td>
      <td>0.778461</td>
      <td>0.507769</td>
      <td>0.830542</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As you can see above, the <code class="docutils literal notranslate"><span class="pre">head()</span></code> method, if used on Jupyter
Notebook, shows the first five lines of the DataFrame with its particular
formatting seen previously, as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>15</th>
      <td>0.684519</td>
      <td>0.861120</td>
      <td>0.323825</td>
      <td>0.204518</td>
      <td>0.372080</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.529079</td>
      <td>0.643015</td>
      <td>0.502276</td>
      <td>0.655703</td>
      <td>0.835930</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.188806</td>
      <td>0.689956</td>
      <td>0.302925</td>
      <td>0.154651</td>
      <td>0.841859</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.235813</td>
      <td>0.978315</td>
      <td>0.273838</td>
      <td>0.912379</td>
      <td>0.842504</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.204934</td>
      <td>0.328844</td>
      <td>0.863875</td>
      <td>0.406913</td>
      <td>0.409407</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9</th>
      <td>0.780700</td>
      <td>0.083553</td>
      <td>0.765147</td>
      <td>0.812450</td>
      <td>0.990125</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.611501</td>
      <td>0.730752</td>
      <td>0.778461</td>
      <td>0.507769</td>
      <td>0.830542</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.684519</td>
      <td>0.861120</td>
      <td>0.323825</td>
      <td>0.204518</td>
      <td>0.372080</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.287888</td>
      <td>0.353575</td>
      <td>0.341708</td>
      <td>0.622832</td>
      <td>0.611452</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>These two methods allow us to see the first and last five lines of the
DataFrame. This default behavior can be changed by passing the number of
lines to be displayed as the argument of the two methods. For example, if
we want to see only the first three rows of the DataFrame, we will get the
results, as shown</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.287888</td>
      <td>0.353575</td>
      <td>0.341708</td>
      <td>0.622832</td>
      <td>0.611452</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.061828</td>
      <td>0.699297</td>
      <td>0.977237</td>
      <td>0.543010</td>
      <td>0.011045</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.865775</td>
      <td>0.534272</td>
      <td>0.686670</td>
      <td>0.375884</td>
      <td>0.722322</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.287888</td>
      <td>0.353575</td>
      <td>0.341708</td>
      <td>0.622832</td>
      <td>0.611452</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="selection">
<h2>2. Selection<a class="headerlink" href="#selection" title="Permalink to this heading">#</a></h2>
<p>During the creation of the DataFrame, we already
learned how to select the elements inside it. In this section, we will address
the selection in the foreground, deepening this topic which will then be the
basis of all the other features present in this and subsequent section</p>
<p>Since the Pandas library is based on the NumPy library, and in its way,
extends some of its features, it wanted to keep both the possibility of being
able to select the elements of the DataFrame and Series with the numbers of
the positions. Both extend this concept through the Indexes and their labels.
Subsetting can then be done via the following:</p>
<ul class="simple">
<li><p>Indexing: Users can select the data using the labels that distinguish
the individual rows and columns, through the Index objects.</p></li>
<li><p>Integer Positioning: Users can select data using positions for integers
of rows and columns, such as NumPy ndarrays.</p></li>
</ul>
<p>When you want to select a single element, things are quite simple – you
specify the label corresponding to the row and the corresponding column
(indexing) or the position within the DataFrame by means of the pair of
integers (integer positioning) – as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
                           <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">],</span>
                           <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>6</td>
      <td>2</td>
      <td>6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>b</th>
      <td>4</td>
      <td>8</td>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>c</th>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>d</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="a-selection-by-labels-the-loc-method">
<h3>2.a) Selection by Labels: The <code class="docutils literal notranslate"><span class="pre">.loc[</span> <span class="pre">]</span></code> method<a class="headerlink" href="#a-selection-by-labels-the-loc-method" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">.loc[</span> <span class="pre">]</span></code> operator focuses on selection based on the labels contained
within the Index objects, as shown as follows:
<code class="docutils literal notranslate"><span class="pre">.loc[</span> <span class="pre">row</span> <span class="pre">labels,</span> <span class="pre">column</span> <span class="pre">labels]</span></code></p>
<p>If you want to select a single element within the DataFrame, you will first
specify the row label and then that of the column, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.287888</td>
      <td>0.353575</td>
      <td>0.341708</td>
      <td>0.622832</td>
      <td>0.611452</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.061828</td>
      <td>0.699297</td>
      <td>0.977237</td>
      <td>0.543010</td>
      <td>0.011045</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.865775</td>
      <td>0.534272</td>
      <td>0.686670</td>
      <td>0.375884</td>
      <td>0.722322</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.427374</td>
      <td>0.628699</td>
      <td>0.383110</td>
      <td>0.208596</td>
      <td>0.301745</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.611501</td>
      <td>0.730752</td>
      <td>0.778461</td>
      <td>0.507769</td>
      <td>0.830542</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.822372</td>
      <td>0.940225</td>
      <td>0.996775</td>
      <td>0.276070</td>
      <td>0.221705</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.981665</td>
      <td>0.263222</td>
      <td>0.483972</td>
      <td>0.448115</td>
      <td>0.698585</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.788616</td>
      <td>0.663250</td>
      <td>0.709085</td>
      <td>0.646127</td>
      <td>0.885067</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.837928</td>
      <td>0.160876</td>
      <td>0.719921</td>
      <td>0.495707</td>
      <td>0.042354</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.780700</td>
      <td>0.083553</td>
      <td>0.765147</td>
      <td>0.812450</td>
      <td>0.990125</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.770597</td>
      <td>0.579099</td>
      <td>0.554982</td>
      <td>0.193273</td>
      <td>0.715738</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.872885</td>
      <td>0.484358</td>
      <td>0.749639</td>
      <td>0.499975</td>
      <td>0.755507</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.537080</td>
      <td>0.950478</td>
      <td>0.162069</td>
      <td>0.004849</td>
      <td>0.256844</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.667947</td>
      <td>0.709389</td>
      <td>0.377085</td>
      <td>0.076337</td>
      <td>0.179740</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.881816</td>
      <td>0.610919</td>
      <td>0.170058</td>
      <td>0.672130</td>
      <td>0.160582</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.684519</td>
      <td>0.861120</td>
      <td>0.323825</td>
      <td>0.204518</td>
      <td>0.372080</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.529079</td>
      <td>0.643015</td>
      <td>0.502276</td>
      <td>0.655703</td>
      <td>0.835930</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.188806</td>
      <td>0.689956</td>
      <td>0.302925</td>
      <td>0.154651</td>
      <td>0.841859</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.235813</td>
      <td>0.978315</td>
      <td>0.273838</td>
      <td>0.912379</td>
      <td>0.842504</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.204934</td>
      <td>0.328844</td>
      <td>0.863875</td>
      <td>0.406913</td>
      <td>0.409407</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<p>A single element as a scalar is obtained as a return value.
Whereas, if you want to select a subset of adjacent elements, you can use
the slicing technique with labels, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">:</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>4</td>
      <td>8</td>
      <td>7</td>
    </tr>
    <tr>
      <th>c</th>
      <td>2</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>d</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>6</td>
      <td>2</td>
      <td>6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>b</th>
      <td>4</td>
      <td>8</td>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>c</th>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>But the columns and rows may also not be contiguous. In this case, you can
use lists containing the labels to be selected, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>c</th>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>So, where we have selections with contiguous rows and columns, it is
advisable to specify the range with slicing, and where instead the rows and
columns are isolated, the labels are specified in the form of lists. However,
using both words in the same column or row selection gives an error, as
shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">:</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>6</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>b</th>
      <td>4</td>
      <td>8</td>
      <td>1</td>
    </tr>
    <tr>
      <th>c</th>
      <td>2</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>6</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>b</th>
      <td>4</td>
      <td>8</td>
      <td>1</td>
    </tr>
    <tr>
      <th>c</th>
      <td>2</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="b-selection-by-location-the-iloc-method">
<h3>2.b) Selection by Location: The <code class="docutils literal notranslate"><span class="pre">.iloc[</span> <span class="pre">]</span></code> method<a class="headerlink" href="#b-selection-by-location-the-iloc-method" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">.iloc[</span> <span class="pre">]</span></code> operator works with the same rules as the selection operator [ ]
for lists in Python. That is, it focuses on the positions of the elements
expressed by sequences of integers from 0 to N-1 with N as the length of the
Index, as shown as follows:
<code class="docutils literal notranslate"><span class="pre">.iloc[</span> <span class="pre">row</span> <span class="pre">number,</span> <span class="pre">column</span> <span class="pre">number]</span></code>
So, if we want to select a single element, it will be enough to add its
numerical coordinates of the corresponding position, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>Whereas, if we want to select a subset of the DataFrame, we can use the
slicing technique by specifying the ranges of the numerical indices if they
are adjacent, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>2</td>
      <td>6</td>
    </tr>
    <tr>
      <th>b</th>
      <td>8</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>And if the elements are not adjacent, we can replace slices with lists, as
shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>4</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.frame.DataFrame
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A    4
C    7
Name: b, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>If you must select a single row, insert the value within a single element list,
to have a DataFrame that preserves the same indexing structure as a return
value, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.series.Series
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="c-selection-on-dtype">
<h3>2.c) Selection on dtype<a class="headerlink" href="#c-selection-on-dtype" title="Permalink to this heading">#</a></h3>
<p>So far, we have seen that the selections can be made by subsetting or by
exploiting the indexing of the DataFrame. But there are also other selection
methods, for instance, based on the values contained in the DataFrame.</p>
<p>For
example, selections can be made based on the type of data (dtype).
To make this type of selection, we do not use an operator, but a method
called <code class="docutils literal notranslate"><span class="pre">select_dtypes()</span></code>. This method accepts the following two possible
parameters:</p>
<ul class="simple">
<li><p>include</p></li>
<li><p>exclude</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">6</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mf">5.1</span><span class="p">,</span><span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mf">4.3</span><span class="p">,</span><span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">]],</span> 
                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> 
                     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>6</td>
      <td>0.3</td>
      <td>one</td>
      <td>True</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2</td>
      <td>5.1</td>
      <td>two</td>
      <td>False</td>
    </tr>
    <tr>
      <th>c</th>
      <td>1</td>
      <td>4.3</td>
      <td>three</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To obtain the list of the dtypes of each single column of the DataFrame,
we can call the dtypes attribute, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A      int64
B    float64
C     object
D       bool
dtype: object
</pre></div>
</div>
</div>
</div>
<p>If, on the other hand, we want to select by exclusion, we use the exclude
parameter instead with a list containing the dtypes we want to exclude, as
shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2_</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bool&#39;</span><span class="p">,</span><span class="s1">&#39;int64&#39;</span><span class="p">])</span>
<span class="n">df2_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>6</td>
      <td>True</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2</td>
      <td>False</td>
    </tr>
    <tr>
      <th>c</th>
      <td>1</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2__</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bool&#39;</span><span class="p">,</span><span class="s1">&#39;int64&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df2__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     B      C
a  0.3    one
b  5.1    two
c  4.3  three
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="filtering">
<h2>3. Filtering<a class="headerlink" href="#filtering" title="Permalink to this heading">#</a></h2>
<p>We saw in the previous section how it is possible to select elements within a
DataFrame (or even a Series) by specifying appropriate spatial indicators
such as labels or numerical position indices. In this section, we will see
another very similar operation, which also selects, but is totally focused on
the values of the elements – filtering. In this case, we will set particular
conditions in the selection designed to select only the elements with the
values that satisfy them. There is, therefore, filtering of the values of a
DataFrame.</p>
<div class="section" id="a-the-boolean-condition">
<h3>3.a) The Boolean condition<a class="headerlink" href="#a-the-boolean-condition" title="Permalink to this heading">#</a></h3>
<p>The Filtering technique is, therefore, based on a particular condition, called
a Boolean condition, which is nothing more than a Boolean expression, that
is, a mathematical expression that results in True and False (Boolean
values).</p>
<p>An example of a Boolean expression could be as follows: <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">&gt;</span> <span class="pre">5</span></code> (values greater than 5)</p>
<p>If this condition is true, it will return True, otherwise False.
These Boolean expressions are characterized by the use of Boolean operators such as <code class="docutils literal notranslate"><span class="pre">(&lt;,&gt;,!</span> <span class="pre">=,</span> <span class="pre">==,</span> <span class="pre">&lt;=,&gt;</span> <span class="pre">=)</span></code>, which are intended to compare two values and set a condition that can either be verified or not.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">x</span> <span class="o">&gt;</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>In the case of DataFrames, this Boolean condition is applied to the values
contained in a particular subset of the DataFrame, establishing which part (column or row) will respond to this condition and returning a Series of Boolean values (<code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>).</p>
<p>The final result is a filtering that returns us a DataFrame that preserves the same structure as the original but that includes only some rows or columns of the original DataFrame.</p>
</div>
<div class="section" id="a-1-filtering-on-the-lines">
<h3>3.a.1. Filtering on the lines<a class="headerlink" href="#a-1-filtering-on-the-lines" title="Permalink to this heading">#</a></h3>
<p>The most intuitive filtering is filtering on lines, that is, the one that will pass
only a few lines of a DataFrame based on a Boolean condition.
We first create a DataFrame of random values between 0 and 1, distributed
over 4 columns, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.626692</td>
      <td>0.775150</td>
      <td>0.495280</td>
      <td>0.752148</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.494610</td>
      <td>0.893088</td>
      <td>0.349038</td>
      <td>0.637473</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.782304</td>
      <td>0.087000</td>
      <td>0.261963</td>
      <td>0.721285</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.336932</td>
      <td>0.070660</td>
      <td>0.818493</td>
      <td>0.842675</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.018090</td>
      <td>0.767243</td>
      <td>0.711748</td>
      <td>0.921943</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.892207</td>
      <td>0.945388</td>
      <td>0.057426</td>
      <td>0.384485</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.175850</td>
      <td>0.426481</td>
      <td>0.103388</td>
      <td>0.661971</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.209132</td>
      <td>0.671702</td>
      <td>0.704205</td>
      <td>0.249831</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.723865</td>
      <td>0.127408</td>
      <td>0.893979</td>
      <td>0.856425</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.714035</td>
      <td>0.245604</td>
      <td>0.358471</td>
      <td>0.236126</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now, we will define a Boolean condition, based on which the selection will
be made. For example, we want to filter only those rows of a DataFrame
that have the value of column A greater than 0.5.</p>
<p>Since these are floating point numbers, let’s add some significant digits, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.500000</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     True
1    False
2     True
3    False
4    False
5     True
6    False
7    False
8     True
9     True
Name: A, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>As an indexing operator, we use the one represented by two square brackets
<code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code>. This operator will then take care of passing only the rows corresponding
to the True values, based on the indices of the Series generated by the
Boolean condition, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3_</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span> <span class="n">df3</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.500000</span> <span class="p">]</span>
<span class="n">df3_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.626692</td>
      <td>0.775150</td>
      <td>0.495280</td>
      <td>0.752148</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.782304</td>
      <td>0.087000</td>
      <td>0.261963</td>
      <td>0.721285</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.892207</td>
      <td>0.945388</td>
      <td>0.057426</td>
      <td>0.384485</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.723865</td>
      <td>0.127408</td>
      <td>0.893979</td>
      <td>0.856425</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.714035</td>
      <td>0.245604</td>
      <td>0.358471</td>
      <td>0.236126</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>But you can also use other indexing operators, such as indexer <code class="docutils literal notranslate"><span class="pre">.loc[</span> <span class="pre">]</span></code>, as
shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3__</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">df3</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.500000</span><span class="p">]</span>
<span class="n">df3__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.626692</td>
      <td>0.775150</td>
      <td>0.495280</td>
      <td>0.752148</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.782304</td>
      <td>0.087000</td>
      <td>0.261963</td>
      <td>0.721285</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.892207</td>
      <td>0.945388</td>
      <td>0.057426</td>
      <td>0.384485</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.723865</td>
      <td>0.127408</td>
      <td>0.893979</td>
      <td>0.856425</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.714035</td>
      <td>0.245604</td>
      <td>0.358471</td>
      <td>0.236126</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="a-2-filtering-on-columns">
<h3>3.a.2. Filtering on columns<a class="headerlink" href="#a-2-filtering-on-columns" title="Permalink to this heading">#</a></h3>
<p>The complementary case to the previous one is filtering on columns. In this
case, only those columns of the DataFrame are filtered, whose values meet
certain requirements. Again, we will define a Boolean condition. For
example, we want to select only those columns whose average of values is
greater than 0.5, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.500000</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A    False
B     True
C    False
D     True
dtype: bool
</pre></div>
</div>
</div>
</div>
<p>From the Series returned as a result, we can see which columns meet this
condition from the elements with the value True. We apply this Boolean
condition to indexer <code class="docutils literal notranslate"><span class="pre">.loc[</span> <span class="pre">]</span></code> to filter on columns, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3__</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">df3</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.500000</span><span class="p">]</span>
<span class="n">df3__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.775150</td>
      <td>0.752148</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.893088</td>
      <td>0.637473</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.087000</td>
      <td>0.721285</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.070660</td>
      <td>0.842675</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.767243</td>
      <td>0.921943</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.945388</td>
      <td>0.384485</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.426481</td>
      <td>0.661971</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.671702</td>
      <td>0.249831</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.127408</td>
      <td>0.856425</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.245604</td>
      <td>0.236126</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="a-3-application-of-multiple-conditions">
<h3>3.a.3. Application of multiple conditions<a class="headerlink" href="#a-3-application-of-multiple-conditions" title="Permalink to this heading">#</a></h3>
<p>In Filtering, you can apply several Boolean conditions at the same time. To
do this, different conditions can be applied at the same time, thanks to the
logical operators <code class="docutils literal notranslate"><span class="pre">AND</span></code>, <code class="docutils literal notranslate"><span class="pre">OR</span></code>, and <code class="docutils literal notranslate"><span class="pre">NOT</span></code>. In the Pandas library, these logical
operators are expressed in the following way</p>
<ul class="simple">
<li><p><strong>&amp;</strong>  ==&gt; (and)</p></li>
<li><p><strong>|</strong>   ==&gt;   (or)</p></li>
<li><p><strong>~</strong>    ==&gt;  (not)</p></li>
</ul>
<p>So, every single condition is enclosed in square brackets and joined
together by the previous logical operators. We can express joint Boolean
conditions in the following way:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.626692</td>
      <td>0.775150</td>
      <td>0.495280</td>
      <td>0.752148</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.494610</td>
      <td>0.893088</td>
      <td>0.349038</td>
      <td>0.637473</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.782304</td>
      <td>0.087000</td>
      <td>0.261963</td>
      <td>0.721285</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.336932</td>
      <td>0.070660</td>
      <td>0.818493</td>
      <td>0.842675</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.018090</td>
      <td>0.767243</td>
      <td>0.711748</td>
      <td>0.921943</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.892207</td>
      <td>0.945388</td>
      <td>0.057426</td>
      <td>0.384485</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.175850</td>
      <td>0.426481</td>
      <td>0.103388</td>
      <td>0.661971</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.209132</td>
      <td>0.671702</td>
      <td>0.704205</td>
      <td>0.249831</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.723865</td>
      <td>0.127408</td>
      <td>0.893979</td>
      <td>0.856425</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.714035</td>
      <td>0.245604</td>
      <td>0.358471</td>
      <td>0.236126</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">df3</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.300000</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df3</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.700000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    False
1    False
2     True
3    False
4     True
5     True
6     True
7     True
8     True
9     True
Name: A, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>Apply it inside an indexing operator or an indexer, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3___</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[(</span><span class="n">df3</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.300000</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df3</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.700000</span><span class="p">)]</span>
<span class="n">df3___</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>0.782304</td>
      <td>0.087000</td>
      <td>0.261963</td>
      <td>0.721285</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.018090</td>
      <td>0.767243</td>
      <td>0.711748</td>
      <td>0.921943</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.892207</td>
      <td>0.945388</td>
      <td>0.057426</td>
      <td>0.384485</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.175850</td>
      <td>0.426481</td>
      <td>0.103388</td>
      <td>0.661971</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.209132</td>
      <td>0.671702</td>
      <td>0.704205</td>
      <td>0.249831</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.723865</td>
      <td>0.127408</td>
      <td>0.893979</td>
      <td>0.856425</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.714035</td>
      <td>0.245604</td>
      <td>0.358471</td>
      <td>0.236126</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If the same Boolean conditions are often used within the code, it would be a
good practice to first define them as variables and then use them when
necessary. For example, by putting the Boolean conditions used previously,
you can write the filtering criteria in a concise and readable way inside the
indexing operator, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond1</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.300000</span>
<span class="n">cond2</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.700000</span>
<span class="n">cond3</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.500000</span>

<span class="n">df3x</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond1</span> <span class="o">|</span> <span class="n">cond2</span> <span class="p">,</span><span class="n">cond3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df3x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          B         D
2  0.087000  0.721285
4  0.767243  0.921943
5  0.945388  0.384485
6  0.426481  0.661971
7  0.671702  0.249831
8  0.127408  0.856425
9  0.245604  0.236126
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="a-4-boolean-reductions">
<h3>3.a.4.  Boolean reductions<a class="headerlink" href="#a-4-boolean-reductions" title="Permalink to this heading">#</a></h3>
<p>One topic related to the concept of filtering is Boolean reductions. There are
a number of methods, called reduction methods, which allow you to obtain
a reduced result, as shown as follows:</p>
<ul class="simple">
<li><p>any()</p></li>
<li><p>all()</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="n">df4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.746494</td>
      <td>0.766544</td>
      <td>0.005141</td>
      <td>0.033434</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.177983</td>
      <td>0.209283</td>
      <td>0.115278</td>
      <td>0.097095</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.578403</td>
      <td>0.918135</td>
      <td>0.761882</td>
      <td>0.997977</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.493776</td>
      <td>0.124595</td>
      <td>0.270445</td>
      <td>0.414917</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.972910</td>
      <td>0.485711</td>
      <td>0.622576</td>
      <td>0.620004</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.442738</td>
      <td>0.507688</td>
      <td>0.210405</td>
      <td>0.547191</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.958552</td>
      <td>0.169463</td>
      <td>0.470003</td>
      <td>0.681968</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.512781</td>
      <td>0.257612</td>
      <td>0.894017</td>
      <td>0.346506</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.211330</td>
      <td>0.501183</td>
      <td>0.427332</td>
      <td>0.459034</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.748325</td>
      <td>0.244369</td>
      <td>0.467238</td>
      <td>0.230617</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>But, let’s see some examples to clarify their function. We apply a Boolean
condition in which all the elements of the DataFrame are evaluated. For
example, we want to know which elements of the DataFrame have a value
greater than 0.1, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df4_</span> <span class="o">=</span> <span class="n">df4</span> <span class="o">&gt;</span> <span class="mf">0.1</span>
<span class="n">df4_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>5</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>6</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>7</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>8</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>9</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In this case, we got a DataFrame full of Boolean values. A reduction
method can be applied to this DataFrame, such as the all() method to
know if, within each column, all the values meet these requirements (all on
True) , as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">df4</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A     True
B     True
C    False
D    False
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">df4</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A    True
B    True
C    True
D    True
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">df4</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="a-5-filtering-with-the-isin-method">
<h3>3.a.5. Filtering with the <code class="docutils literal notranslate"><span class="pre">.isin(</span> <span class="pre">)</span></code> method<a class="headerlink" href="#a-5-filtering-with-the-isin-method" title="Permalink to this heading">#</a></h3>
<p>Another method of Filtering is <code class="docutils literal notranslate"><span class="pre">.isin(</span> <span class="pre">)</span></code>. This method lets you know if one or
more elements are present inside an object such as a DataFrame or a Series.
In this regard, we define an example DataFrame, with predefined values, as
shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="n">df5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>7</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now, let’s apply the <code class="docutils literal notranslate"><span class="pre">.isin(</span> <span class="pre">)</span></code> method with some values to search for, as
follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df5_</span> <span class="o">=</span> <span class="n">df5</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">df5_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As we can see, by passing a list of values as an argument to the <code class="docutils literal notranslate"><span class="pre">.isin(</span> <span class="pre">)</span></code>
method applied to the DataFrame, we get a Boolean DataFrame of the same
size, where we have True if the value belongs to the list, and False if it
doesn’t exist.</p>
<p>As we can see, this is also a filtering operation. Then, passing this Boolean DataFrame to the indexing operator, you get a filtering of the values, in which only those which correspond to True as a
value will be passed, while all the others, which correspond to False, will be evaluated as <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df5</span><span class="p">[</span><span class="n">df5_</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df5__</span> <span class="o">=</span> <span class="n">df5</span><span class="p">[</span><span class="n">df5</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df5__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="editing">
<h2>4. Editing<a class="headerlink" href="#editing" title="Permalink to this heading">#</a></h2>
<p>In the previous sections, we saw how to select some parts (subset) of a
DataFrame to view them, to extract them as a new object (new Series or
DataFrame), or more often, to manipulate them later, operating on their
values in some way.
Another basic operation that is carried out is that of editing. That is, once
you have created a DataFrame with a constructor, it will be necessary to make changes to its
structure. Sometimes, it will be necessary to add at the end, or even insert
inside, new elements (such as rows or columns), and other times, it will be
necessary to remove entire rows or columns.</p>
<p>In this section, we will, therefore, deal with the editing of a complex object
such as a DataFrame, so that we can then learn how to make all the changes
necessary to prepare a DataFrame for analysis</p>
<div class="section" id="a-adding-inserting-and-deleting-a-column-in-a-dataframe">
<h3>4.a. Adding, inserting, and deleting a column in a DataFrame<a class="headerlink" href="#a-adding-inserting-and-deleting-a-column-in-a-dataframe" title="Permalink to this heading">#</a></h3>
<p>You will have understood by now that due to the way the DataFrames are
structured within them, you can think of the columns as separate Series,
assembled together to form data tables. So the editing operations of a
DataFrame working on the columns are somewhat easier.
Let’s create an example DataFrame like the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df6</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]],</span> 
                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> 
                     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="n">df6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>b</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>c</th>
      <td>7</td>
      <td>8</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Adding a column at the end is a fairly simple operation. It is sufficient to
select a column that does not yet exist, specify a new label within the
indexing operator, and enhance it in some way. In this way, a new column
will automatically be created which will be added after the last existing
column. For example, if we value a non-existent column with a scalar value, , we
will get a column completely valued with that number, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df6</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">17</span> 
<span class="n">df6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>17</td>
    </tr>
    <tr>
      <th>b</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>17</td>
    </tr>
    <tr>
      <th>c</th>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>From now on, if you select this column, the behavior will be the normal
selection behavior, where the returned value will be a Series, as shown as
follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df6</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    17
b    17
c    17
Name: D, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df6</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">]</span>
<span class="n">df6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>17</td>
      <td>13</td>
    </tr>
    <tr>
      <th>b</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>17</td>
      <td>14</td>
    </tr>
    <tr>
      <th>c</th>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>17</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The same technique can be used to update the values of an already existing
column. For example, passing a list of values to an already existing column
will replace those already present, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df6</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span><span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">]</span>
<span class="n">df6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>one</td>
      <td>13</td>
    </tr>
    <tr>
      <th>b</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>two</td>
      <td>14</td>
    </tr>
    <tr>
      <th>c</th>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>three</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To enhance a column, you can use an existing Series instead of a list. In this
case, however, you must pay close attention to the correspondence between
the labels of the Series and those of the DataFrame, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">df6</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sr</span> 
<span class="n">df6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>10</td>
      <td>13</td>
    </tr>
    <tr>
      <th>b</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>11</td>
      <td>14</td>
    </tr>
    <tr>
      <th>c</th>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>12</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Another very useful operation is the removal of a column from a
DataFrame. The del keyword exists in Python that can be used for this
purpose, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">del</span> <span class="n">df6</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>
<span class="n">df6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>10</td>
    </tr>
    <tr>
      <th>b</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>11</td>
    </tr>
    <tr>
      <th>c</th>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In this case, the column is permanently removed from the DataFrame, but
there may be cases where the removed column wants to be preserved in
some way. The <code class="docutils literal notranslate"><span class="pre">.pop()</span></code> method allows you to remove the column from the
DataFrame and return it as Series that can be stored in a new variable, as
shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sr</span> <span class="o">=</span> <span class="n">df6</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>  
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">sr</span><span class="p">))</span>   
<span class="n">df6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.series.Series&#39;&gt;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>b</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>c</th>
      <td>7</td>
      <td>8</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Another useful method for editing a column within a DataFrame is the
<code class="docutils literal notranslate"><span class="pre">insert()</span></code> method. This method inserts a new column within a DataFrame
in a predetermined position. For example, we can insert the Series we extracted earlier with the <code class="docutils literal notranslate"><span class="pre">pop()</span></code>
method, back into the DataFrame in position 1, calling it as label <code class="docutils literal notranslate"><span class="pre">'Z'</span></code>. All
this information is passed as arguments to the <code class="docutils literal notranslate"><span class="pre">insert()</span></code> function, as shown
as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df6</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span> 
<span class="n">df6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>Z</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
      <td>10</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>b</th>
      <td>4</td>
      <td>11</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>c</th>
      <td>7</td>
      <td>12</td>
      <td>8</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The same <code class="docutils literal notranslate"><span class="pre">insert()</span></code> method can also be used to copy a column within a
DataFrame. For example, in the previous case, the column to be copied is
passed instead of an external Series, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df6</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">df6</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="n">df6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>Z</th>
      <th>B</th>
      <th>B2</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
      <td>10</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>b</th>
      <td>4</td>
      <td>11</td>
      <td>5</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>c</th>
      <td>7</td>
      <td>12</td>
      <td>8</td>
      <td>8</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="b-adding-new-columns-with-assign">
<h3>4.b. Adding new columns with assign()<a class="headerlink" href="#b-adding-new-columns-with-assign" title="Permalink to this heading">#</a></h3>
<p>Among the methods applicable to DataFrames that have editing functions,
there is the <code class="docutils literal notranslate"><span class="pre">.assign(</span> <span class="pre">)</span></code> method that allows you to create new columns to be
added easily, deriving them from those already present. For example, we
can add a new column to the DataFrame starting from the values of an
already existing column by multiplying it by 2, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df7</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> 
                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> 
                     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="n">df7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>9</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>b</th>
      <td>9</td>
      <td>9</td>
      <td>8</td>
    </tr>
    <tr>
      <th>c</th>
      <td>9</td>
      <td>3</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df7_</span> <span class="o">=</span> <span class="n">df7</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">D</span> <span class="o">=</span> <span class="n">df7</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">df7_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>9</td>
      <td>1</td>
      <td>6</td>
      <td>18</td>
    </tr>
    <tr>
      <th>b</th>
      <td>9</td>
      <td>9</td>
      <td>8</td>
      <td>18</td>
    </tr>
    <tr>
      <th>c</th>
      <td>9</td>
      <td>3</td>
      <td>2</td>
      <td>18</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">.assign()</span></code> method does not modify the original DataFrame but creates
a new copy of it as a return value. So, the result can be assigned to a new
variable, as we have just done, or reassigned to the original DataFrame,
modifying it. The choice of what to do is therefore up to the user, as shown
as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df7__</span> <span class="o">=</span> <span class="n">df7</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">D</span> <span class="o">=</span> <span class="n">df7</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">df7__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>9</td>
      <td>1</td>
      <td>6</td>
      <td>18</td>
    </tr>
    <tr>
      <th>b</th>
      <td>9</td>
      <td>9</td>
      <td>8</td>
      <td>18</td>
    </tr>
    <tr>
      <th>c</th>
      <td>9</td>
      <td>3</td>
      <td>2</td>
      <td>18</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>But the <code class="docutils literal notranslate"><span class="pre">.assign()</span></code> method can also be used to overwrite an existing column,
which is often very useful for correcting or modifying the data within the
DataFrame, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df7x</span> <span class="o">=</span> <span class="n">df7</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">df7</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]))</span>
<span class="n">df7x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>9</td>
      <td>1</td>
      <td>6</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>9</td>
      <td>9</td>
      <td>8</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>9</td>
      <td>3</td>
      <td>2</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As you can see, in addition to arithmetic operations, functions can also be
used to modify the values of a column. Another useful application of the
<code class="docutils literal notranslate"><span class="pre">.assign()</span></code> method is to create new columns containing values generated by
special functions. For example, we often need to generate columns
containing the same numeric value, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df7y</span> <span class="o">=</span> <span class="n">df7</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">df7y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>9</td>
      <td>1</td>
      <td>6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>b</th>
      <td>9</td>
      <td>9</td>
      <td>8</td>
      <td>1</td>
    </tr>
    <tr>
      <th>c</th>
      <td>9</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="descriptive-statistics">
<h2>5. Descriptive Statistics<a class="headerlink" href="#descriptive-statistics" title="Permalink to this heading">#</a></h2>
<p>Pandas is a library designed for data analysis, and the DataFrames are the
basic objects on which all the related activities are carried out. So having an
idea of their contents and their structure at the outset is important in order to
better target the operations to be carried out. Among the basic activities,
there is, therefore, the calculation of general statistics that can somehow
give an idea of the values contained within the DataFrame under analysis.
In this section, we will see many basic features that the Pandas library
offers to obtain this type of descriptive data.</p>
<div class="section" id="a-the-describe-method">
<h3>5.a) The <code class="docutils literal notranslate"><span class="pre">.describe(</span> <span class="pre">)</span></code> method<a class="headerlink" href="#a-the-describe-method" title="Permalink to this heading">#</a></h3>
<p>Inside the Pandas library, there is a describe() method that calculates a
whole series of descriptive statistics of the reference DataFrame, as shown
as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df8</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">df8</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.974515</td>
      <td>0.692295</td>
      <td>0.285047</td>
      <td>0.622410</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.856988</td>
      <td>0.456917</td>
      <td>0.259579</td>
      <td>0.758956</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.639641</td>
      <td>0.808532</td>
      <td>0.300489</td>
      <td>0.390449</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.765654</td>
      <td>0.631529</td>
      <td>0.296863</td>
      <td>0.866590</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.635931</td>
      <td>0.956638</td>
      <td>0.515898</td>
      <td>0.586072</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.259867</td>
      <td>0.658147</td>
      <td>0.925965</td>
      <td>0.027619</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.128660</td>
      <td>0.199379</td>
      <td>0.286584</td>
      <td>0.241974</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.444105</td>
      <td>0.204736</td>
      <td>0.440765</td>
      <td>0.496245</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.375771</td>
      <td>0.696342</td>
      <td>0.024393</td>
      <td>0.205614</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.603613</td>
      <td>0.895587</td>
      <td>0.343027</td>
      <td>0.287609</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>It is launched directly on the DataFrame to be analyzed, and the result is a
table of descriptive statistics carried out at the column level and reported in
the structure of a DataFrame, as shown</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df8</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.568474</td>
      <td>0.620010</td>
      <td>0.367861</td>
      <td>0.448354</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.266482</td>
      <td>0.261071</td>
      <td>0.233825</td>
      <td>0.264717</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.128660</td>
      <td>0.199379</td>
      <td>0.024393</td>
      <td>0.027619</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.392855</td>
      <td>0.500570</td>
      <td>0.285431</td>
      <td>0.253383</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.619772</td>
      <td>0.675221</td>
      <td>0.298676</td>
      <td>0.443347</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.734151</td>
      <td>0.780484</td>
      <td>0.416331</td>
      <td>0.613326</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.974515</td>
      <td>0.956638</td>
      <td>0.925965</td>
      <td>0.866590</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The statistics processed are also returned in the form of DataFrame, each of
which is processed by a single column. Among the reported values, we see
the element count, the mean and its standard deviation, the maximum and
minimum value, and 3 percentiles. This information will be reported only
for the columns of the DataFrame that contain numeric values, as shown</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df8_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;two&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;three&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;four&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;five&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">]],</span> 
                   <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;numb&#39;</span><span class="p">,</span><span class="s1">&#39;word&#39;</span><span class="p">,</span><span class="s1">&#39;bool&#39;</span><span class="p">])</span>
<span class="n">df8_</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>numb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.581139</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>5.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If, on the other hand, there are no columns with numerical values to be
calculated, it will present in addition to the number of elements present,
other statistics such as the number of unique elements, and the most
frequent value for every single column with its frequency, as shown</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df8_</span><span class="p">[[</span><span class="s1">&#39;word&#39;</span><span class="p">,</span><span class="s1">&#39;bool&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>word</th>
      <th>bool</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>top</th>
      <td>one</td>
      <td>False</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>1</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>So in a DataFrame with many columns, it would be a good practice to be
able to select only a few columns (or exclude the ones that don’t interest us)
without having to first make a selection of subsettings and then applying
describe() as done before. In this regard, there are two parameters,
include and exclude, which allow us to explicitly specify which columns
should be included or excluded in the calculation of descriptive statistics.
The peculiarity is that you do not pass lists containing labels, but dtypes.
That is, the selection is made by the type of data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df8_</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>numb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.581139</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>5.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df8_</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#df.mean(axis=0) #df.mean()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numb    3.0
bool    0.4
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df8_</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#df.mean(axis=1)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1.0
1    1.0
2    2.0
3    2.0
4    2.5
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df8_</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numb    1.581139
bool    0.547723
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">std</span> <span class="o">=</span> <span class="p">(</span> <span class="n">df8_</span> <span class="o">-</span> <span class="n">df8_</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,))</span><span class="o">/</span> <span class="n">df8_</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">std</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">std</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>bool    0.0
numb    0.0
word    NaN
dtype: object
bool    1.0
numb    1.0
word    NaN
dtype: object
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="transposition-sorting-and-reindexing">
<h2>6.  Transposition, Sorting and Reindexing<a class="headerlink" href="#transposition-sorting-and-reindexing" title="Permalink to this heading">#</a></h2>
<p>In this final section, we will see some of the techniques that somehow
rearrange the internal structure of the DataFrame by acting at the index
level. In fact, the order of the labels within a DataFrame is not immutable
but can be changed during the analysis. There are, therefore, some
techniques that act at this level including transposition, sorting, and
reindexing.</p>
<div class="section" id="a-transposition">
<h3>6.a. Transposition<a class="headerlink" href="#a-transposition" title="Permalink to this heading">#</a></h3>
<p>The transposition of a DataFrame is equivalent to the mathematical
operation of the transposition of a matrix. In this operation, the rows
become the columns and vice versa. Applying a transposition to a
DataFrame will, therefore, have the exchange of labels between index and
columns, with the consequent reordering of the values related to them, as
shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df9</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]],</span> 
                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> 
                     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="n">df9</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>b</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>c</th>
      <td>7</td>
      <td>8</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To carry out the transposition of a DataFrame, it is sufficient to recall the
attribute T, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df9</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>1</td>
      <td>4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>B</th>
      <td>2</td>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th>C</th>
      <td>3</td>
      <td>6</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="b-sorting">
<h3>6.b. Sorting<a class="headerlink" href="#b-sorting" title="Permalink to this heading">#</a></h3>
<p>Often, when loading a DataFrame from a data source, it happens that the
order of the rows or columns is not the desired one. Or during the various�
analysis phases, we may wish to sort the values of a specific column in the
ascending or descending order. All these sorting operations can be
summarized in the following three types:</p>
<ul class="simple">
<li><p>Sorting by labels</p></li>
<li><p>Sorting by values</p></li>
<li><p>Sorting by a combination of both</p></li>
</ul>
<p>All of these sorting types are feasible with the Panda library. For this
purpose, we will create a DataFrame with the inside of the index and
columns labels arranged in an unordered way (this is practically the case for
almost all real DataFrames), as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df10</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> 
                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> 
                     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="n">df10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>1</td>
      <td>6</td>
      <td>6</td>
      <td>5</td>
    </tr>
    <tr>
      <th>d</th>
      <td>8</td>
      <td>2</td>
      <td>3</td>
      <td>8</td>
    </tr>
    <tr>
      <th>c</th>
      <td>1</td>
      <td>6</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>a</th>
      <td>6</td>
      <td>5</td>
      <td>3</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="b-1-sorting-by-label">
<h3>6.b.1. Sorting by label<a class="headerlink" href="#b-1-sorting-by-label" title="Permalink to this heading">#</a></h3>
<p>Sorting by labels, or sorting by index, is based on sorting the labels in
axis or columns based on their value (numeric or string), and it is performed
efficiently by the sort_index() method. By default, this method puts the
labels on the index in the DataFrame in the ascending order. Matching the
values on each row will also follow the same order, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df10_</span> <span class="o">=</span> <span class="n">df10</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="n">df10_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>6</td>
      <td>5</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>b</th>
      <td>1</td>
      <td>6</td>
      <td>6</td>
      <td>5</td>
    </tr>
    <tr>
      <th>c</th>
      <td>1</td>
      <td>6</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>d</th>
      <td>8</td>
      <td>2</td>
      <td>3</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As we can see from the result, the rows of the DataFrame have been
reordered following the ascending order of the index labels. We, therefore,
had a sort order by row, while the order of the columns remained
unchanged. If, on the other hand, we need to sort the labels in descending
order, simply add the ascending parameter and set it to False <code class="docutils literal notranslate"><span class="pre">(by</span> <span class="pre">default,</span> <span class="pre">ascending</span> <span class="pre">=</span> <span class="pre">True)</span></code>, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df10__</span> <span class="o">=</span> <span class="n">df10</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df10__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>d</th>
      <td>8</td>
      <td>2</td>
      <td>3</td>
      <td>8</td>
    </tr>
    <tr>
      <th>c</th>
      <td>1</td>
      <td>6</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>b</th>
      <td>1</td>
      <td>6</td>
      <td>6</td>
      <td>5</td>
    </tr>
    <tr>
      <th>a</th>
      <td>6</td>
      <td>5</td>
      <td>3</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If we want to sort the labels in columns in ascending order, it will be
necessary to explicitly define the parameter <code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">=</span> <span class="pre">1</span></code> (by default axis = 0), as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df10x</span> <span class="o">=</span> <span class="n">df10</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df10x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>6</td>
      <td>5</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>d</th>
      <td>3</td>
      <td>8</td>
      <td>8</td>
      <td>2</td>
    </tr>
    <tr>
      <th>c</th>
      <td>4</td>
      <td>5</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>a</th>
      <td>3</td>
      <td>1</td>
      <td>6</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df10y</span> <span class="o">=</span> <span class="n">df10</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df10y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>D</th>
      <th>C</th>
      <th>B</th>
      <th>A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>6</td>
      <td>1</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>d</th>
      <td>2</td>
      <td>8</td>
      <td>8</td>
      <td>3</td>
    </tr>
    <tr>
      <th>c</th>
      <td>6</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>a</th>
      <td>5</td>
      <td>6</td>
      <td>1</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df10z</span> <span class="o">=</span> <span class="n">df10</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df10z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>3</td>
      <td>1</td>
      <td>6</td>
      <td>5</td>
    </tr>
    <tr>
      <th>b</th>
      <td>6</td>
      <td>5</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>c</th>
      <td>4</td>
      <td>5</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>d</th>
      <td>3</td>
      <td>8</td>
      <td>8</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="b-2-sorting-by-values">
<h3>6.b.2. Sorting by values<a class="headerlink" href="#b-2-sorting-by-values" title="Permalink to this heading">#</a></h3>
<p>Another way to sort a DataFrame is to sort the rows or columns according
to their contained values. Sorting by values is done by the sort_values()
method. In order to work, this method needs a mandatory parameter that
must be explicitly set. The ‘by parameter’ must be labeled columns,
according to which, the values within the column will be sorted in the
ascending order, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df10t</span> <span class="o">=</span> <span class="n">df10</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">df10t</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>d</th>
      <td>8</td>
      <td>2</td>
      <td>3</td>
      <td>8</td>
    </tr>
    <tr>
      <th>a</th>
      <td>6</td>
      <td>5</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>c</th>
      <td>1</td>
      <td>6</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>b</th>
      <td>1</td>
      <td>6</td>
      <td>6</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The by parameter can also accept a list of column labels. The
<code class="docutils literal notranslate"><span class="pre">sort_values()</span></code> method will first sort the column values corresponding to
the first label in the list. Then, in the context of the equal values present in
this column, it will sort on the column corresponding to the second label in
the list, and so on, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df10</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">df10p</span> <span class="o">=</span> <span class="n">df10</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="n">df10p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>1</td>
      <td>6</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>d</th>
      <td>8</td>
      <td>2</td>
      <td>0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>a</th>
      <td>6</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>c</th>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Finally, both the <code class="docutils literal notranslate"><span class="pre">sort_index()</span></code> method and the <code class="docutils literal notranslate"><span class="pre">sort_values()</span></code> method will
not modify the original DataFrame but will return an ordered copy of it.
Any changes made to the latter will not affect the original DataFrame in the
least, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df10q</span> <span class="o">=</span> <span class="n">df10</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df10q</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">df10q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>6</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>b</th>
      <td>1</td>
      <td>6</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>c</th>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>d</th>
      <td>8</td>
      <td>2</td>
      <td>0</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df10r</span> <span class="o">=</span> <span class="n">df10</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">df10r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>1</td>
      <td>6</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>d</th>
      <td>8</td>
      <td>2</td>
      <td>0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>c</th>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>a</th>
      <td>6</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="reindexing">
<h2>7. Reindexing<a class="headerlink" href="#reindexing" title="Permalink to this heading">#</a></h2>
<p>Reindexing is the fundamental method of aligning data in Pandas.
Reindexing means conforming the data to match a given set of labels along
a particular axis. This involves a set of things, which are as follows:</p>
<ul class="simple">
<li><p>Reordering of existing data to respond to the new set of labels</p></li>
<li><p>The insertion of NaN in the positions where there is no correspondence</p></li>
<li><p>Possibility of filling in cases of missing data (NaN) with special data following appropriate rules</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df11</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> 
                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> 
                     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="n">df11</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>5</td>
      <td>8</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>d</th>
      <td>7</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>c</th>
      <td>3</td>
      <td>2</td>
      <td>0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>a</th>
      <td>5</td>
      <td>8</td>
      <td>7</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To reindex, use the <code class="docutils literal notranslate"><span class="pre">reindex()</span></code> method specifying the new order of the
labels that the DataFrame must have. The method will not operate on the
reference DataFrame, but will return a copy of the DataFrame that will
follow the new indexing rules. To select which particular Index object will
be reindexed, we will add the axis parameter with its specific value as the
function argument, as shown as follows:</p>
<ul class="simple">
<li><p>axis = 0 to edit rows (index)</p></li>
<li><p>axis = 1 to edit columns (columns)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df11_</span> <span class="o">=</span> <span class="n">df11</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df11_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>5</td>
      <td>8</td>
      <td>7</td>
      <td>7</td>
    </tr>
    <tr>
      <th>b</th>
      <td>5</td>
      <td>8</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>c</th>
      <td>3</td>
      <td>2</td>
      <td>0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>d</th>
      <td>7</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The new DataFrame will be a completely independent copy, and any
changes made to it will not affect the original one in the least, as shown as
follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df11_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">df11_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>5</td>
      <td>8</td>
      <td>7</td>
      <td>7</td>
    </tr>
    <tr>
      <th>b</th>
      <td>5</td>
      <td>0</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>c</th>
      <td>3</td>
      <td>2</td>
      <td>0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>d</th>
      <td>7</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df11</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>5</td>
      <td>8</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>d</th>
      <td>7</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>c</th>
      <td>3</td>
      <td>2</td>
      <td>0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>a</th>
      <td>5</td>
      <td>8</td>
      <td>7</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The same goes for the columns, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df11__</span> <span class="o">=</span> <span class="n">df11</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df11__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>5</td>
      <td>6</td>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th>d</th>
      <td>4</td>
      <td>4</td>
      <td>7</td>
      <td>2</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0</td>
      <td>7</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>a</th>
      <td>7</td>
      <td>7</td>
      <td>5</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>But what happens if we insert labels that are not present in our DataFrame?
Or, if we omit some present label? Refer to the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df11x</span> <span class="o">=</span> <span class="n">df11</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df11x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>E</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>5</td>
      <td>NaN</td>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th>d</th>
      <td>4</td>
      <td>NaN</td>
      <td>7</td>
      <td>2</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0</td>
      <td>NaN</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>a</th>
      <td>7</td>
      <td>NaN</td>
      <td>5</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="a-reindexing-using-another-dataframe-as-a-reference">
<h3>7.a. Reindexing using another DataFrame as a reference<a class="headerlink" href="#a-reindexing-using-another-dataframe-as-a-reference" title="Permalink to this heading">#</a></h3>
<p>There is also the possibility of using a reference DataFrame from which to
take the order of the indexes (both by row and by column) and apply it to
our DataFrame. This is possible with the <code class="docutils literal notranslate"><span class="pre">reindex_like(</span> <span class="pre">)</span></code> method. This
method will also not change the object that it is called on but will return a
copy of the DataFrame as a result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df11y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> 
                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">],</span> 
                     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="n">df11y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We will apply the <code class="docutils literal notranslate"><span class="pre">reindex_like(</span> <span class="pre">)</span></code> method on our DataFrame on which we
want to reindex, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df11z</span> <span class="o">=</span> <span class="n">df11</span><span class="o">.</span><span class="n">reindex_like</span><span class="p">(</span><span class="n">df11</span><span class="p">)</span>
<span class="n">df11z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>5</td>
      <td>8</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>d</th>
      <td>7</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>c</th>
      <td>3</td>
      <td>2</td>
      <td>0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>a</th>
      <td>5</td>
      <td>8</td>
      <td>7</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Also in this case, if in the reference DataFrame, there are labels that do not
exist in our DataFrame on which to index, these rows or columns will be
added to the new DataFrame returned with all the <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values (missing
values) inside. Whereas, if in the reference DataFrame, some labels are not
present, the corresponding rows or columns will be removed from the new
DataFrame returned, as shown as follows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> 
                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">],</span> 
                     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;W&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">])</span>
<span class="n">df12</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>W</th>
      <th>Z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df12_</span> <span class="o">=</span> <span class="n">df12</span><span class="o">.</span><span class="n">reindex_like</span><span class="p">(</span><span class="n">df12</span><span class="p">)</span>
<span class="n">df12_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>W</th>
      <th>Z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">#</a></h2>
<p>In this chapter, we dealt with a whole series of basic operations that apply to
DataFrame (and also to Series) and which greatly help in understanding this
type of object and how they work. The concept of selection is very
important because it allows us to focus our attention on a subset of the DataFrame. This type of object often has dimensions that are too large to be considered in their entirety, and in addition to the often-insufficient
selection, a filtering system that allows us to select only what meets
particular requirements that come to our aid.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./part_1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="05_Grouping_Data.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 5: Grouping the Data</p>
      </div>
    </a>
    <a class="right-next"
       href="07_Data%20Organization%20Methods.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 7: Data Organization Methods</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#viewing-data">1. Viewing Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-the-head-and-the-tail-method">1.a) The <em>.head()</em>  and the <em>.tail()</em> method</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#selection">2. Selection</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-selection-by-labels-the-loc-method">2.a) Selection by Labels: The <code class="docutils literal notranslate"><span class="pre">.loc[</span> <span class="pre">]</span></code> method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-selection-by-location-the-iloc-method">2.b) Selection by Location: The <code class="docutils literal notranslate"><span class="pre">.iloc[</span> <span class="pre">]</span></code> method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-selection-on-dtype">2.c) Selection on dtype</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering">3. Filtering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-the-boolean-condition">3.a) The Boolean condition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-1-filtering-on-the-lines">3.a.1. Filtering on the lines</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-2-filtering-on-columns">3.a.2. Filtering on columns</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-3-application-of-multiple-conditions">3.a.3. Application of multiple conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-4-boolean-reductions">3.a.4.  Boolean reductions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-5-filtering-with-the-isin-method">3.a.5. Filtering with the <code class="docutils literal notranslate"><span class="pre">.isin(</span> <span class="pre">)</span></code> method</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#editing">4. Editing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-adding-inserting-and-deleting-a-column-in-a-dataframe">4.a. Adding, inserting, and deleting a column in a DataFrame</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-adding-new-columns-with-assign">4.b. Adding new columns with assign()</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptive-statistics">5. Descriptive Statistics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-the-describe-method">5.a) The <code class="docutils literal notranslate"><span class="pre">.describe(</span> <span class="pre">)</span></code> method</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transposition-sorting-and-reindexing">6.  Transposition, Sorting and Reindexing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-transposition">6.a. Transposition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-sorting">6.b. Sorting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-1-sorting-by-label">6.b.1. Sorting by label</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-2-sorting-by-values">6.b.2. Sorting by values</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reindexing">7. Reindexing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-reindexing-using-another-dataframe-as-a-reference">7.a. Reindexing using another DataFrame as a reference</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Rockefeller
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>